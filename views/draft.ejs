<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/draft/style.css" rel="stylesheet">
  <meta content="" name="description">

  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="/draft/img/favicon.png" rel="icon">
  <link href="/draft/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
    rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="/draft/vendor/aos/aos.css" rel="stylesheet">
  <link href="/draft/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/draft/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="/draft/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="/draft/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="/draft/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <title>Draft - <%= author %>
  </title>
  <script type="text/javascript">

    function changeFunc() {
     var selectBox = document.getElementById("selectBox");
     var selectedValue = selectBox.options[selectBox.selectedIndex].value;
     console.log(selectedValue);
    }
  
   </script>
</head>

<body>
  <!-- header-->
  <header id="header" class="header fixed-top">
    <div class="container-fluid container-xl d-flex align-items-center justify-content-between">
      <a href="/" class="logo d-flex align-items-center" style="text-decoration: none;">
        <img src="/draft/img/logo.png" alt="" />
        <span>Blogr</span>
      </a>
      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto" href="/search/null">Search</a></li>
          <li><a class="nav-link scrollto" href="#contact">Contact</a></li>
          <li><a class="getstarted scrollto" href="/profile/<%= author %>" style="text-decoration: none;">
              <%= author %>
            </a></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav>
    </div>
  </header>
  <!-- End Header -->

  <script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/header@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/header@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/link@2.2.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/raw"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/simple-image@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/image@2.3.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/checklist@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/list@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/embed@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/quote@latest"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

  <script>
    function loadeditordata(data) {
      return editor = new EditorJS({
        placeholder: 'Let`s write an awesome story!',
        tools: {
          header: Header,
          raw: RawTool,
          image: SimpleImage,
          checklist: {
            class: Checklist,
            inlineToolbar: true,
          },
          list: {
            class: List,
            inlineToolbar: true,
          },
          embed: Embed,
          quote: Quote,
        },
        data: JSON.parse(data),
        // autofocus: true
        // readOnly: true
      });
    }
  </script>

  <section id="secid">
    <!-- border border-secondary -->
    <form action="/" method="GET" class="">

      <!-- Image -->
      <div id="editorjs" class="des">
        <div class="container py-5 " style="float: none;">
          <div class="image-area mt-4 crp">
            <img id="imageResult" alt="" class="img-fluid rounded shadow-sm mx-auto d-block ">
          </div>
          <div class="row py-4 bardes" style="margin: 0 auto;">
            <input id="upload" type="file" onchange="readURL(this);" class="form-control border-0">
            <label for="upload" class="btn btn-secondary m-0 rounded-pill px-4"> <i
                class="fa fa-cloud-upload mr-2 text-muted"></i>Choose file</label>
          </div>
        </div>

        <!-- Title -->
        <div class="container">
          <input class="blog-title" id="title" contenteditable="true" placeholder="Title" value="">
        </div>
      </div>
  
  


 


      <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
      <script src="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.jquery.min.js"></script>
      <link href="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.min.css" rel="stylesheet"/>


<!-- start -->


  <div class="container">
    <div style="text-align: center; margin-bottom: 5%;">
    
      <h3>Voice Assitance</h3>
      <div class="app" style="margin-top: 3.5%;"> 
        <div class="row">
          <div class="col-3"></div>
          <div class="col-6" style="margin-right: 0%;">
            <div class="input-single form-group shadow-textarea">
              <textarea id="note-textarea" class="form-control z-depth-1" placeholder="Create a new note by typing or using voice recognition." rows="6"></textarea>
            </div>
          </div>
          <div class="col-3" style="text-align: left; justify-content: center; align-content: center;">
            <div style="margin-top: 7%;"><button  style = "background-color: #6C757D;"class="btn btn-primary" id="start-record-btn" title="Start Recording" onclick = "prel()">Start</button></div>
        <div style="margin-top: 3%;"><button  style = "background-color: #6C757D;"class="btn btn-primary" id="pause-record-btn" title="Pause Recording" onclick = "prel()">Pause</button></div>
          </div>
        </div>
    
            
      </div>
      
      </div>
    </div>



<!-- multiple dropdown -->
<script>
  var tags = [];
function check()
  {
    var selectedValue = taglist.options;
    tags = [];
    for(var i=0;i<selectedValue.length;i++)
    {
      if(selectedValue[i].selected)
        tags.push(selectedValue[i].value);
    }
  }
</script>
<select data-placeholder="Select Tags" multiple="multiple" class="chosen-select" id = "taglist" name="test" onchange="check()">
  <option value="0"></option>
  <% for(let i=0;i<alltag.length;i++) {%>
  <option value = <%= alltag[i] %>><%= alltag[i] %></option>
  <% } %>
</select>

<script>
    var selectedValue = taglist.options;
    var tag = '<%=tag %>';
    
    for(var i=0;i<tag.length;i++)
    {
      if(tag[i] != ',')
      {
        for(var j=0;j<selectedValue.length;j++)
        { 
          if(selectedValue[j].value == tag[i])
            selectedValue[j].selected = true;
        }
      }
    }
</script>
<h1><%= tag %></h1>

<script> 
$(".chosen-select").chosen({ no_results_text: "Oops, nothing found!"})
</script>



      <div style="text-align: center;">
        <button type="submit" onclick="publishdata()" class="btn btn-secondary m-0 rounded-pill px-4 ">Publish</button>
        <button onclick="draftdata()" class="btn btn-secondary m-0 rounded-pill px-4 ">Draft</button>
      </div>
    </form>
      <!-- <button type="submit" onclick="publishdata()" class="btn">Publish</button>
      <button class="btn" onclick="draftdata()"> Draft </button> -->
      <br><br>
    
    

  </section>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="/draft/app.js"></script>

  <script>
    function prel()
    {
      event.preventDefault();
    }


    let author = '<%-author%>'
    let key = '<%-key%>'
    let data = '<%-data%>'
    if (data) {
      // console.log("found");
      // console.log(data);
      editor = loadeditordata(data);
      document.getElementById("title").value = '<%-title%>';
      document.getElementById("imageResult").src = '<%-covimg%>';
    }
    else {
      editor = new EditorJS({
        placeholder: 'Let`s write an awesome story!',
        tools: {
          header: Header,
          raw: RawTool,
          image: SimpleImage,
          checklist: {
            class: Checklist,
            inlineToolbar: true,
          },
          list: {
            class: List,
            inlineToolbar: true,
          },
          embed: Embed,
          quote: Quote,
        },
        // autofocus: true
        // readOnly: true
      });
    }
    console.log(key);

    function draftdata() {
      
      if (!document.getElementById("title").value) {
        alert("Enter Blog Title");
        return;
      }
      if (!document.getElementById("imageResult").src) {
        alert("Enter Cover Image");
        return;
      }
      editor
        .save()
        .then((output) => {
          fetch('/saveblogdata', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              title: document.getElementById("title").value,
              blogdata: JSON.stringify(output),
              author: author,
              key: key,
              draft: true,
              covimg: document.getElementById("imageResult").src,
              tag : tags,
            }),
          });
        });
        event.preventDefault();
    }

    function publishdata() {
      if (!document.getElementById("title").value) {
        alert("Enter Blog Title");
        return;
      }
      if (!document.getElementById("imageResult").src) {
        alert("Enter Cover Image");
        return;
      }
      editor
        .save()
        .then((output) => {
          fetch('/saveblogdata', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              title: document.getElementById("title").value,
              blogdata: JSON.stringify(output),
              author: author,
              key: key,
              draft: false,
              covimg: document.getElementById("imageResult").src,
              tag : tags,
            }),
          });
        });
    }
  </script>
  <script src="/draft/main.js"></script>


  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">
    <div class="footer-top">
      <div class="container">
        <div class="row gy-4">
          <div class="col-lg-5 col-md-12 footer-info">
            <a href="/" class="logo d-flex align-items-center" style="text-decoration: none;">
              <img src="/draft/img/logo.png" alt="" />
              <span>Blogr</span>
            </a>
            <p>
              A free open-source platform to share your ideas with the world and grow together.
            </p>
            <div class="social-links mt-3">
              <a href="https://twitter.com/MridulMittal20" class="twitter"><i class="bi bi-twitter"
                  style="color: black"></i></a>
              <a href="https://www.facebook.com/mridul.mittal.90" class="facebook"><i class="bi bi-facebook"
                  style="color: black"></i></a>
              <a href="https://www.instagram.com/mridul_2008/" class="instagram"><i class="bi bi-instagram"
                  style="color: black"></i></a>
              <a href="https://www.linkedin.com/in/mridul-mittal-6463231a8/" class="linkedin"><i class="bi bi-linkedin"
                  style="color: black"></i></a>
            </div>
          </div>

          <div class="col-lg-7 col-6 footer-links">
            <div class="copyright">
              &copy; Copyright <strong><span>Blogr</span></strong>. All Rights Reserved
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <!-- End Footer -->

</body>

</html>